<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/ledstrip.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.1/jquery.js"></script>
    <script type="text/javascript" src="javascripts/rAF.js"></script>
    <script type="text/javascript" src="javascripts/ledstrip.js"></script>
    <script type="text/javascript" src="javascripts/ws2812.js"></script>
    <script type="text/javascript" src="javascripts/color_wave.js"></script>
    <script type="text/javascript" src="javascripts/water_torture.js"></script>
    <script type="text/javascript" src="javascripts/chasers.js"></script>
    <script type="text/javascript">
    var strip, animation; // need to be global

    $(document).ready(function(){
      var container = $('.ledstrip')[0];
      var light_count = 30;
      strip = LEDstrip(container, light_count);
      var driver = new ColorWave(strip);
      driver.init();
      animation = driver.animate.bind(driver)();

      $('#animselect').change(function(e) {
        var newanim = $(e.target).val();
        console.log('change! ' + newanim); 
        animation = cancelAnimationFrame(animation);
        switch(newanim) {
          case 'torture':
            driver = new water_torture(strip);
            break;
          case 'wave':
            driver = new ColorWave(strip);
            break;
          case 'chasers':
            driver = new Chasers(strip);
            break;
      /*
          case 'cycle': 
            cycle.color_cycle();
            console.log('torture ' + animation);
            break;
          case 'flares':        
            driver = new flare();
            break;
      */
          case 'stop':
            animation = cancelAnimationFrame(animation);
            return;
            break;
        } // /switch
        driver.init();
        animation = driver.animate();
      });
    });
    </script>

    <title>LEDstrip by dougalcampbell</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>LEDstrip</h1>
        <h2>JavaScript simulation of WS2812 LED strips commonly used with Arduino</h2>

        <section id="downloads">
          <a href="https://github.com/dougalcampbell/LEDStrip/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/dougalcampbell/LEDStrip/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/dougalcampbell/LEDStrip" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h3><a name="ledstrip-simulation" class="anchor" href="#ledstrip-simulation"><span class="octicon octicon-link"></span></a>LEDstrip simulation</h3>

<div class="ledstrip"></div>
<br />
<form>
  <select id="animselect">
    <option value="wave">Color Wave</option>
    <option value="torture">Water Torture</option>
    <option value="chasers">Chasers</option>
    <!-- <option value="cycle">Color Cycle</option> -->
    <!-- option value="flares">Flares</option -->
    <option value="stop">Stop</option>
  </select>
</form>

<h3><a name="example" class="anchor" href="#example"><span class="octicon octicon-link"></span></a>Usage example</h3>

<pre><code>    var container = $('.mylights')[0]; // Container DIV in the page
    var colors = [ // blue gradient
      [0,0,50],
      [0,0,100],
      [0,0,150],
      [0,0,200],
      [0,0,250]
    ];
    var size = colors.length;

    
    var strip = LEDstrip(container, size) // Initialize
      .setcolors(colors)  // chain commands
      .send();
      
    colors.forEach(function(val,idx){ // fiddle with colors
      colors[idx][0] = colors[4-idx][2];
      colors[idx][1] = (colors[idx][0] + colors[idx][2]) >> 1; // g = (r + b) / 2
    });
    
    strip.buffer = colors; // set the color buffer directly
    strip.send();
    
    // assume that animate() is a function that manipulates strip.buffer[]...
    var rAF_id = requestAnimationFrame(animate);
    var i = 0;
    
    function animate() {
      rAF_id = requestAnimationFrame(animate);
      if (i == size) i = 0; // loop around the array

      /* generate random rgb values */
      var r = Math.floor(Math.random() * 255);
      var g = Math.floor(Math.random() * 255);
      var b = Math.floor(Math.random() * 255);

      strip.buffer[i++] = [r, g, b];
      strip.send();
    }
</code></pre>

<p>For more information:</p>
<ul>
  <li><a href="https://github.com/DannyHavenith/ws2811">Danny Havenith's WS2811 Arduino library</a></li>
  <li><a href="http://rurandom.org/justintime/index.php?title=Driving_the_WS2811_at_800_kHz_with_an_8_MHz_AVR">Detailed description and videos</a></li>
</ul>

      </section>
    </div>

    
  </body>
</html>